{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///D:/react/leadsmarket/config/db.js"],"sourcesContent":["import mongoose from 'mongoose';\n\nconst MONGODB_URI = process.env.MONGODB_URI || 'mongodb://localhost:27017/lead_system';\n\nlet cached = global.mongoose;\n\nif (!cached) {\n  cached = global.mongoose = { conn: null, promise: null };\n}\n\nasync function connectDB() {\n  if (cached.conn) {\n    return cached.conn;\n  }\n\n  if (!cached.promise) {\n    const opts = {\n      bufferCommands: false,\n    };\n\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\n      return mongoose;\n    });\n  }\n\n  try {\n    cached.conn = await cached.promise;\n  } catch (e) {\n    cached.promise = null;\n    throw e;\n  }\n\n  return cached.conn;\n}\n\nexport default connectDB;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAE/C,IAAI,SAAS,yDAAO,QAAQ;AAE5B,IAAI,CAAC,QAAQ;IACX,SAAS,yDAAO,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AACzD;AAEA,eAAe;IACb,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;QAClB;QAEA,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,OAAO;QACT;IACF;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,GAAG;QACV,OAAO,OAAO,GAAG;QACjB,MAAM;IACR;IAEA,OAAO,OAAO,IAAI;AACpB;uCAEe","debugId":null}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///D:/react/leadsmarket/services/klaviyoService.js"],"sourcesContent":["// services/klaviyoService.js\r\nimport axios from 'axios';\r\n\r\nclass KlaviyoService {\r\n  constructor() {\r\n    this.privateKey = process.env.KLAVIYO_PRIVATE_KEY || 'pk_54e1768b846d819e1eaafee5d8c6ae169e';\r\n    this.listId = process.env.KLAVIYO_LIST_ID || 'WgUpfq';\r\n    this.baseUrl = 'https://a.klaviyo.com/api';\r\n    this.revision = '2025-10-15';\r\n  }\r\n\r\n  /**\r\n   * Create or update a profile in Klaviyo\r\n   * @param {Object} leadData - The lead data from your database\r\n   * @returns {Promise<string>} - Profile ID\r\n   */\r\n  async createOrUpdateProfile(leadData) {\r\n    try {\r\n      const profilePayload = {\r\n        data: {\r\n          type: 'profile',\r\n          attributes: {\r\n            email: leadData.email,\r\n            phone_number: leadData.phone,\r\n            first_name: leadData.firstName,\r\n            last_name: leadData.lastName,\r\n            properties: {\r\n              // Address Information\r\n              Address: leadData.address1,\r\n              City: leadData.city,\r\n              State: leadData.state,\r\n              ZipCode: leadData.zipCode,\r\n              ResidenceType: leadData.residenceType,\r\n              MonthsAtAddress: leadData.monthsAtAddress,\r\n              \r\n              // Financial Information\r\n              RequestedAmount: leadData.requestedAmount,\r\n              MonthlyIncome: leadData.monthlyIncome,\r\n              IncomeType: leadData.incomeType,\r\n              \r\n              // Employment Information\r\n              EmployerName: leadData.employerName || '',\r\n              MonthsEmployed: leadData.monthsEmployed || 0,\r\n              PayFrequency: leadData.payFrequency || '',\r\n              \r\n              // Banking Information\r\n              BankName: leadData.bankName || '',\r\n              BankAccountType: leadData.bankAccountType || '',\r\n              MonthsAtBank: leadData.monthsAtBank || 0,\r\n              \r\n              // Additional Information\r\n              LoanPurpose: leadData.loanPurpose || '',\r\n              CreditRating: leadData.creditRating || '',\r\n              BestTimeToCall: leadData.bestTimeToCall || '',\r\n              \r\n              // Date of Birth\r\n              DOB: `${leadData.dobMonth}/${leadData.dobDay}/${leadData.dobYear}`,\r\n              \r\n              // Metadata\r\n              Source: 'LeadsMarket Form',\r\n              TrackingId: leadData.trackingId,\r\n              ClientIP: leadData.clientIP,\r\n              CreatedAt: leadData.createdAt || new Date().toISOString(),\r\n              UpdatedAt: leadData.updatedAt || new Date().toISOString()\r\n            }\r\n          }\r\n        }\r\n      };\r\n\r\n      console.log('üì§ Creating/Updating Klaviyo profile for:', leadData.email);\r\n\r\n      const response = await axios.post(\r\n        `${this.baseUrl}/profile-import/`,\r\n        profilePayload,\r\n        {\r\n          headers: {\r\n            'Authorization': `Klaviyo-API-Key ${this.privateKey}`,\r\n            'Content-Type': 'application/json',\r\n            'Accept': 'application/json',\r\n            'revision': this.revision\r\n          }\r\n        }\r\n      );\r\n\r\n      if (response.status === 200 || response.status === 201) {\r\n        const profileId = response.data.data.id;\r\n        console.log('‚úÖ Profile created/updated successfully. Profile ID:', profileId);\r\n        return profileId;\r\n      } else {\r\n        throw new Error(`Unexpected status code: ${response.status}`);\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Error creating/updating Klaviyo profile:', error.response?.data || error.message);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add a profile to a specific list\r\n   * @param {string} profileId - The Klaviyo profile ID\r\n   * @returns {Promise<boolean>}\r\n   */\r\n  async addProfileToList(profileId) {\r\n    try {\r\n      const listPayload = {\r\n        data: [\r\n          {\r\n            type: 'profile',\r\n            id: profileId\r\n          }\r\n        ]\r\n      };\r\n\r\n      console.log('üì§ Adding profile to list:', this.listId);\r\n\r\n      const response = await axios.post(\r\n        `${this.baseUrl}/lists/${this.listId}/relationships/profiles`,\r\n        listPayload,\r\n        {\r\n          headers: {\r\n            'Authorization': `Klaviyo-API-Key ${this.privateKey}`,\r\n            'Content-Type': 'application/json',\r\n            'Accept': 'application/json',\r\n            'revision': this.revision\r\n          }\r\n        }\r\n      );\r\n\r\n      if (response.status === 204) {\r\n        console.log('‚úÖ Profile added to list successfully');\r\n        return true;\r\n      } else {\r\n        throw new Error(`Unexpected status code: ${response.status}`);\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Error adding profile to list:', error.response?.data || error.message);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sync lead to Klaviyo (create profile and add to list)\r\n   * @param {Object} leadData - The lead data from your database\r\n   * @returns {Promise<Object>} - Result object\r\n   */\r\n  async syncLeadToKlaviyo(leadData) {\r\n    try {\r\n      console.log('üöÄ Starting Klaviyo sync for lead:', leadData.email);\r\n\r\n      // Step 1: Create or update the profile\r\n      const profileId = await this.createOrUpdateProfile(leadData);\r\n\r\n      // Step 2: Add the profile to the list\r\n      await this.addProfileToList(profileId);\r\n\r\n      console.log('‚úÖ Lead successfully synced to Klaviyo');\r\n\r\n      return {\r\n        success: true,\r\n        profileId: profileId,\r\n        message: 'Lead synced to Klaviyo successfully'\r\n      };\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Klaviyo sync failed:', error.message);\r\n      \r\n      return {\r\n        success: false,\r\n        error: error.message,\r\n        message: 'Failed to sync lead to Klaviyo'\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Bulk sync multiple leads to Klaviyo\r\n   * @param {Array} leads - Array of lead data objects\r\n   * @returns {Promise<Object>} - Summary of results\r\n   */\r\n  async bulkSyncLeads(leads) {\r\n    const results = {\r\n      total: leads.length,\r\n      successful: 0,\r\n      failed: 0,\r\n      errors: []\r\n    };\r\n\r\n    console.log(`üöÄ Starting bulk sync of ${leads.length} leads...`);\r\n\r\n    for (const lead of leads) {\r\n      try {\r\n        await this.syncLeadToKlaviyo(lead);\r\n        results.successful++;\r\n      } catch (error) {\r\n        results.failed++;\r\n        results.errors.push({\r\n          email: lead.email,\r\n          error: error.message\r\n        });\r\n      }\r\n\r\n      // Add a small delay to respect rate limits\r\n      await new Promise(resolve => setTimeout(resolve, 100));\r\n    }\r\n\r\n    console.log(`‚úÖ Bulk sync complete. Success: ${results.successful}, Failed: ${results.failed}`);\r\n\r\n    return results;\r\n  }\r\n\r\n  /**\r\n   * Track a custom event for a profile\r\n   * @param {string} email - Profile email\r\n   * @param {string} eventName - Event name\r\n   * @param {Object} properties - Event properties\r\n   * @returns {Promise<boolean>}\r\n   */\r\n  async trackEvent(email, eventName, properties = {}) {\r\n    try {\r\n      const eventPayload = {\r\n        data: {\r\n          type: 'event',\r\n          attributes: {\r\n            profile: {\r\n              email: email\r\n            },\r\n            metric: {\r\n              name: eventName\r\n            },\r\n            properties: properties,\r\n            time: new Date().toISOString()\r\n          }\r\n        }\r\n      };\r\n\r\n      const response = await axios.post(\r\n        `${this.baseUrl}/events/`,\r\n        eventPayload,\r\n        {\r\n          headers: {\r\n            'Authorization': `Klaviyo-API-Key ${this.privateKey}`,\r\n            'Content-Type': 'application/json',\r\n            'Accept': 'application/json',\r\n            'revision': this.revision\r\n          }\r\n        }\r\n      );\r\n\r\n      if (response.status === 202) {\r\n        console.log(`‚úÖ Event \"${eventName}\" tracked for ${email}`);\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n\r\n    } catch (error) {\r\n      console.error('‚ùå Error tracking event:', error.response?.data || error.message);\r\n      return false;\r\n    }\r\n  }\r\n}\r\n\r\nexport default new KlaviyoService();"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 301, "column": 0}, "map": {"version":3,"sources":["file:///D:/react/leadsmarket/models/Lead.js"],"sourcesContent":["// models/Lead.js\nimport mongoose from 'mongoose';\nimport klaviyoService from '../services/klaviyoService.js';\n\nconst leadSchema = new mongoose.Schema({\n  // Personal Information\n  firstName: { type: String, required: true },\n  lastName: { type: String, required: true },\n  email: { type: String, required: true },\n  phone: { type: String, required: true },\n  \n  // Date of Birth\n  dobMonth: { type: Number, required: true },\n  dobDay: { type: Number, required: true },\n  dobYear: { type: Number, required: true },\n  \n  // Address\n  address1: { type: String, required: true },\n  city: { type: String, required: true },\n  state: { type: String, required: true },\n  zipCode: { type: String, required: true },\n  monthsAtAddress: { type: Number, required: true },\n  residenceType: { type: String, required: true }, // Own/Rent\n  \n  // Financial\n  requestedAmount: { type: Number, required: true },\n  ssn: { type: String, required: true },\n  monthlyIncome: { type: Number, required: true },\n  incomeType: { type: String, required: true },\n  \n  // Employment\n  employerName: String,\n  monthsEmployed: Number,\n  payFrequency: String,\n  nextPayDate: Date,\n  directDeposit: Boolean,\n  \n  // Banking\n  bankName: String,\n  bankABA: String,\n  bankAccountNumber: String,\n  bankAccountType: String,\n  debitCard: Boolean,\n  monthsAtBank: Number,\n  \n  // Drivers License\n  driversLicense: String,\n  driversLicenseState: String,\n  \n  // Additional\n  bestTimeToCall: String,\n  loanPurpose: String,\n  creditRating: String,\n  ownHome: Boolean,\n  ownCar: Boolean,\n  activeMilitary: Boolean,\n  \n  // Tracking\n  clientIP: String,\n  clientUserAgent: String,\n  trackingId: String,\n  note: String,\n  \n  // Klaviyo Integration\n  klaviyoProfileId: String,\n  klaviyoSyncStatus: {\n    type: String,\n    enum: ['pending', 'synced', 'failed'],\n    default: 'pending'\n  },\n  klaviyoSyncedAt: Date,\n  klaviyoSyncError: String,\n  \n  // Metadata\n  createdAt: { type: Date, default: Date.now },\n  updatedAt: { type: Date, default: Date.now }\n});\n\n// Middleware: Update the updatedAt field on save\nleadSchema.pre('save', function(next) {\n  this.updatedAt = Date.now();\n  next();\n});\n\n// Middleware: Sync to Klaviyo after saving\nleadSchema.post('save', async function(doc) {\n  try {\n    console.log('üîÑ Post-save hook triggered for lead:', doc.email);\n    \n    // Only sync if not already synced or if data has changed\n    if (doc.klaviyoSyncStatus !== 'synced' || doc.isModified()) {\n      console.log('üì§ Syncing lead to Klaviyo...');\n      \n      const result = await klaviyoService.syncLeadToKlaviyo({\n        email: doc.email,\n        phone: doc.phone,\n        firstName: doc.firstName,\n        lastName: doc.lastName,\n        address1: doc.address1,\n        city: doc.city,\n        state: doc.state,\n        zipCode: doc.zipCode,\n        residenceType: doc.residenceType,\n        monthsAtAddress: doc.monthsAtAddress,\n        requestedAmount: doc.requestedAmount,\n        monthlyIncome: doc.monthlyIncome,\n        incomeType: doc.incomeType,\n        employerName: doc.employerName,\n        monthsEmployed: doc.monthsEmployed,\n        payFrequency: doc.payFrequency,\n        bankName: doc.bankName,\n        bankAccountType: doc.bankAccountType,\n        monthsAtBank: doc.monthsAtBank,\n        loanPurpose: doc.loanPurpose,\n        creditRating: doc.creditRating,\n        bestTimeToCall: doc.bestTimeToCall,\n        dobMonth: doc.dobMonth,\n        dobDay: doc.dobDay,\n        dobYear: doc.dobYear,\n        trackingId: doc.trackingId,\n        clientIP: doc.clientIP,\n        createdAt: doc.createdAt,\n        updatedAt: doc.updatedAt\n      });\n\n      if (result.success) {\n        // Update the document with Klaviyo sync status\n        await mongoose.model('Lead').updateOne(\n          { _id: doc._id },\n          {\n            $set: {\n              klaviyoProfileId: result.profileId,\n              klaviyoSyncStatus: 'synced',\n              klaviyoSyncedAt: new Date(),\n              klaviyoSyncError: null\n            }\n          }\n        );\n        console.log('‚úÖ Lead synced to Klaviyo successfully');\n      } else {\n        // Update with error status\n        await mongoose.model('Lead').updateOne(\n          { _id: doc._id },\n          {\n            $set: {\n              klaviyoSyncStatus: 'failed',\n              klaviyoSyncError: result.error\n            }\n          }\n        );\n        console.error('‚ùå Failed to sync lead to Klaviyo:', result.error);\n      }\n    }\n  } catch (error) {\n    console.error('‚ùå Error in Klaviyo sync hook:', error.message);\n    // Don't throw error to prevent lead save from failing\n  }\n});\n\n// Middleware: Sync to Klaviyo after update\nleadSchema.post('findOneAndUpdate', async function(doc) {\n  if (doc) {\n    try {\n      console.log('üîÑ Post-update hook triggered for lead:', doc.email);\n      \n      const result = await klaviyoService.syncLeadToKlaviyo({\n        email: doc.email,\n        phone: doc.phone,\n        firstName: doc.firstName,\n        lastName: doc.lastName,\n        address1: doc.address1,\n        city: doc.city,\n        state: doc.state,\n        zipCode: doc.zipCode,\n        residenceType: doc.residenceType,\n        monthsAtAddress: doc.monthsAtAddress,\n        requestedAmount: doc.requestedAmount,\n        monthlyIncome: doc.monthlyIncome,\n        incomeType: doc.incomeType,\n        employerName: doc.employerName,\n        monthsEmployed: doc.monthsEmployed,\n        payFrequency: doc.payFrequency,\n        bankName: doc.bankName,\n        bankAccountType: doc.bankAccountType,\n        monthsAtBank: doc.monthsAtBank,\n        loanPurpose: doc.loanPurpose,\n        creditRating: doc.creditRating,\n        bestTimeToCall: doc.bestTimeToCall,\n        dobMonth: doc.dobMonth,\n        dobDay: doc.dobDay,\n        dobYear: doc.dobYear,\n        trackingId: doc.trackingId,\n        clientIP: doc.clientIP,\n        createdAt: doc.createdAt,\n        updatedAt: doc.updatedAt\n      });\n\n      if (result.success) {\n        await mongoose.model('Lead').updateOne(\n          { _id: doc._id },\n          {\n            $set: {\n              klaviyoProfileId: result.profileId,\n              klaviyoSyncStatus: 'synced',\n              klaviyoSyncedAt: new Date(),\n              klaviyoSyncError: null\n            }\n          }\n        );\n        console.log('‚úÖ Lead update synced to Klaviyo successfully');\n      } else {\n        await mongoose.model('Lead').updateOne(\n          { _id: doc._id },\n          {\n            $set: {\n              klaviyoSyncStatus: 'failed',\n              klaviyoSyncError: result.error\n            }\n          }\n        );\n        console.error('‚ùå Failed to sync lead update to Klaviyo:', result.error);\n      }\n    } catch (error) {\n      console.error('‚ùå Error in Klaviyo update sync hook:', error.message);\n    }\n  }\n});\n\n// Static method: Manual sync for existing leads\nleadSchema.statics.syncToKlaviyo = async function(leadId) {\n  try {\n    const lead = await this.findById(leadId);\n    if (!lead) {\n      throw new Error('Lead not found');\n    }\n\n    const result = await klaviyoService.syncLeadToKlaviyo({\n      email: lead.email,\n      phone: lead.phone,\n      firstName: lead.firstName,\n      lastName: lead.lastName,\n      address1: lead.address1,\n      city: lead.city,\n      state: lead.state,\n      zipCode: lead.zipCode,\n      residenceType: lead.residenceType,\n      monthsAtAddress: lead.monthsAtAddress,\n      requestedAmount: lead.requestedAmount,\n      monthlyIncome: lead.monthlyIncome,\n      incomeType: lead.incomeType,\n      employerName: lead.employerName,\n      monthsEmployed: lead.monthsEmployed,\n      payFrequency: lead.payFrequency,\n      bankName: lead.bankName,\n      bankAccountType: lead.bankAccountType,\n      monthsAtBank: lead.monthsAtBank,\n      loanPurpose: lead.loanPurpose,\n      creditRating: lead.creditRating,\n      bestTimeToCall: lead.bestTimeToCall,\n      dobMonth: lead.dobMonth,\n      dobDay: lead.dobDay,\n      dobYear: lead.dobYear,\n      trackingId: lead.trackingId,\n      clientIP: lead.clientIP,\n      createdAt: lead.createdAt,\n      updatedAt: lead.updatedAt\n    });\n\n    if (result.success) {\n      lead.klaviyoProfileId = result.profileId;\n      lead.klaviyoSyncStatus = 'synced';\n      lead.klaviyoSyncedAt = new Date();\n      lead.klaviyoSyncError = null;\n      await lead.save();\n    }\n\n    return result;\n  } catch (error) {\n    console.error('Error in manual Klaviyo sync:', error);\n    throw error;\n  }\n};\n\n// Static method: Bulk sync all unsynced leads\nleadSchema.statics.syncAllToKlaviyo = async function() {\n  try {\n    const unsyncedLeads = await this.find({\n      $or: [\n        { klaviyoSyncStatus: 'pending' },\n        { klaviyoSyncStatus: 'failed' },\n        { klaviyoSyncStatus: { $exists: false } }\n      ]\n    });\n\n    console.log(`Found ${unsyncedLeads.length} leads to sync`);\n\n    const leadsData = unsyncedLeads.map(lead => ({\n      _id: lead._id,\n      email: lead.email,\n      phone: lead.phone,\n      firstName: lead.firstName,\n      lastName: lead.lastName,\n      address1: lead.address1,\n      city: lead.city,\n      state: lead.state,\n      zipCode: lead.zipCode,\n      residenceType: lead.residenceType,\n      monthsAtAddress: lead.monthsAtAddress,\n      requestedAmount: lead.requestedAmount,\n      monthlyIncome: lead.monthlyIncome,\n      incomeType: lead.incomeType,\n      employerName: lead.employerName,\n      monthsEmployed: lead.monthsEmployed,\n      payFrequency: lead.payFrequency,\n      bankName: lead.bankName,\n      bankAccountType: lead.bankAccountType,\n      monthsAtBank: lead.monthsAtBank,\n      loanPurpose: lead.loanPurpose,\n      creditRating: lead.creditRating,\n      bestTimeToCall: lead.bestTimeToCall,\n      dobMonth: lead.dobMonth,\n      dobDay: lead.dobDay,\n      dobYear: lead.dobYear,\n      trackingId: lead.trackingId,\n      clientIP: lead.clientIP,\n      createdAt: lead.createdAt,\n      updatedAt: lead.updatedAt\n    }));\n\n    const results = await klaviyoService.bulkSyncLeads(leadsData);\n\n    // Update sync status for all leads\n    for (const leadData of leadsData) {\n      await this.updateOne(\n        { _id: leadData._id },\n        {\n          $set: {\n            klaviyoSyncStatus: 'synced',\n            klaviyoSyncedAt: new Date()\n          }\n        }\n      );\n    }\n\n    return results;\n  } catch (error) {\n    console.error('Error in bulk Klaviyo sync:', error);\n    throw error;\n  }\n};\n\nexport default mongoose.models.Lead || mongoose.model('Lead', leadSchema);"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 702, "column": 0}, "map": {"version":3,"sources":["file:///D:/react/leadsmarket/models/SoldLead.js"],"sourcesContent":["// models/SoldLead.js\nimport mongoose from 'mongoose';\n\nconst soldLeadSchema = new mongoose.Schema({\n  leadId: { \n    type: mongoose.Schema.Types.ObjectId, \n    ref: 'Lead', \n    required: true \n  },\n  \n  // LeadsMarket Response - Result can be \"1\", \"2\", \"4\" or string values\n  result: { \n    type: String, \n    required: true\n    // Removed enum to allow any value (1, 2, 4, Accepted, Rejected, Duplicate, Errors)\n  },\n  \n  campaignId: String,\n  leadsMarketLeadId: String,\n  price: Number,\n  redirectUrl: String,\n  \n  // Error details (if any)\n  errors: [{\n    field: String,\n    value: String,\n    description: String\n  }],\n  \n  messages: [String],\n  \n  // Raw response\n  rawResponse: mongoose.Schema.Types.Mixed,\n  \n  // Metadata\n  createdAt: { type: Date, default: Date.now }\n});\n\nexport default mongoose.models.SoldLead || mongoose.model('SoldLead', soldLeadSchema);"],"names":[],"mappings":"AAAA,qBAAqB;;;;;AACrB;;AAEA,MAAM,iBAAiB,IAAI,oHAAQ,CAAC,MAAM,CAAC;IACzC,QAAQ;QACN,MAAM,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QACpC,KAAK;QACL,UAAU;IACZ;IAEA,sEAAsE;IACtE,QAAQ;QACN,MAAM;QACN,UAAU;IAEZ;IAEA,YAAY;IACZ,mBAAmB;IACnB,OAAO;IACP,aAAa;IAEb,yBAAyB;IACzB,QAAQ;QAAC;YACP,OAAO;YACP,OAAO;YACP,aAAa;QACf;KAAE;IAEF,UAAU;QAAC;KAAO;IAElB,eAAe;IACf,aAAa,oHAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK;IAExC,WAAW;IACX,WAAW;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;AAC7C;uCAEe,oHAAQ,CAAC,MAAM,CAAC,QAAQ,IAAI,oHAAQ,CAAC,KAAK,CAAC,YAAY","debugId":null}},
    {"offset": {"line": 750, "column": 0}, "map": {"version":3,"sources":["file:///D:/react/leadsmarket/pages/api/lead.js"],"sourcesContent":["// pages/api/lead.js\nimport connectDB from '../../config/db';\nimport Lead from '../../models/Lead';\nimport SoldLead from '../../models/SoldLead';\nimport axios from 'axios';\n\nexport default async function handler(req, res) {\n  if (req.method !== 'POST') {\n    return res.status(405).json({ error: 'Method not allowed' });\n  }\n\n  try {\n    await connectDB();\n\n    const formData = req.body;\n\n    // 1. Save lead to database\n    const lead = new Lead({\n      firstName: formData.fName,\n      lastName: formData.lName,\n      email: formData.email,\n      phone: formData.phone,\n      dobMonth: formData.bMonth,\n      dobDay: formData.bDay,\n      dobYear: formData.bYear,\n      address1: formData.address1,\n      city: formData.city,\n      state: formData.state,\n      zipCode: formData.zip,\n      monthsAtAddress: formData.lengthAtAddress,\n      residenceType: formData.rentOwn === 'own' ? 'Own' : 'Rent',\n      requestedAmount: formData.amount,\n      ssn: formData.ssn,\n      monthlyIncome: formData.monthlyNetIncome,\n      incomeType: mapIncomeType(formData.incomeSource),\n      employerName: formData.employerName,\n      monthsEmployed: formData.monthsEmployed,\n      payFrequency: formData.payFrequency,\n      nextPayDate: formData.nextPayDate,\n      directDeposit: formData.directDeposit,\n      bankName: formData.bankName,\n      bankABA: formData.bankABA,\n      bankAccountNumber: formData.bankAccountNumber,\n      bankAccountType: formData.bankAccountType,\n      debitCard: formData.debitCard,\n      monthsAtBank: formData.monthsAtBank,\n      driversLicense: formData.driversLicense,\n      driversLicenseState: formData.driversLicenseState,\n      bestTimeToCall: formData.callTime,\n      loanPurpose: mapLoanPurpose(formData.loan_reason),\n      creditRating: mapCreditRating(formData.credit_type),\n      ownHome: formData.rentOwn === 'own',\n      ownCar: formData.ownCar,\n      activeMilitary: formData.activeMilitary,\n      clientIP: formData.ip_address,\n      clientUserAgent: formData.user_agent,\n      trackingId: formData.atrk,\n      note: formData.note\n    });\n\n    await lead.save();\n\n    // 2. Prepare LeadsMarket API payload\n    const leadsMarketPayload = {\n      CampaignID: process.env.LEADSMARKET_CAMPAIGN_ID || \"331246\",\n      CampaignKey: process.env.LEADSMARKET_CAMPAIGN_KEY || \"b52b889f-0112-4fd0-a679-1bbc6fd5b361\",\n      LeadtypeId: 19,\n      Responsetype: \"JSON\",\n      \n      // Personal\n      FirstName: formData.fName,\n      LastName: formData.lName,\n      Email: formData.email,\n      PhoneHome: formData.phone, // 10 digits as string\n      \n      // DOB - MM/DD/YYYY format\n      DOB: `${String(formData.bMonth).padStart(2, '0')}/${String(formData.bDay).padStart(2, '0')}/${formData.bYear}`,\n      \n      // Address\n      Address1: formData.address1,\n      City: formData.city,\n      State: formData.state,\n      ZipCode: formData.zip, // 5 digits as string\n      MonthsAtAddress: parseInt(formData.lengthAtAddress),\n      ResidenceType: formData.rentOwn === 'own' ? 'Own' : 'Rent',\n      \n      // Financial\n      RequestedAmount: parseInt(formData.amount),\n      SSN: formData.ssn, // 9 digits as string\n      MonthlyIncome: parseInt(formData.monthlyNetIncome),\n      IncomeType: mapIncomeTypeAPI(formData.incomeSource), // Fixed mapping\n      \n      // Employment\n      EmployerName: formData.employerName || \"Self\",\n      MonthsEmployed: parseInt(formData.monthsEmployed) || 12,\n      PayFrequency: formData.payFrequency || \"Biweekly\",\n      PayDate1: formData.nextPayDate || getNextFriday(),\n      DirectDeposit: formData.directDeposit ? \"true\" : \"false\",\n      \n      // Banking\n      BankName: formData.bankName || \"Bank\",\n      BankABA: formData.bankABA || \"123456789\",\n      BankAccountNumber: formData.bankAccountNumber || \"1234567890\",\n      BankAccountType: formData.bankAccountType || \"Checking\",\n      DebitCard: formData.debitCard ? \"true\" : \"false\",\n      MonthsAtBank: parseInt(formData.monthsAtBank) || 12,\n      \n      // Drivers License\n      DriversLicense: formData.driversLicense || \"DL123456\",\n      DriversLicenseState: formData.driversLicenseState || formData.state,\n      \n      // Additional\n      BestTimeToCall: mapCallTimeAPI(formData.callTime),\n      LoanPurpose: mapLoanPurposeAPI(formData.loan_reason),\n      Credit: mapCreditRatingAPI(formData.credit_type),\n      OwnHome: formData.rentOwn === 'own' ? \"true\" : \"false\",\n      OwnCar: formData.ownCar ? \"true\" : \"false\",\n      ActiveMilitary: formData.activeMilitary ? \"true\" : \"false\",\n      AcceptedTerms: \"true\",\n      \n      // Tracking\n      ClientIP: formData.ip_address || \"0.0.0.0\",\n      ClientUserAgent: formData.user_agent || \"Mozilla/5.0\",\n      ClientURL: process.env.NEXT_PUBLIC_APP_URL || \"https://yourdomain.com\",\n      \n      // Pricing\n      MinimumPrice: 0,\n      MaxResponseTime: 120\n    };\n\n    console.log('üì§ Submitting to LeadsMarket...');\n    console.log('Payload:', JSON.stringify(leadsMarketPayload, null, 2));\n    \n    // 3. Submit to LeadsMarket API\n    const response = await axios.post(\n      'https://api.leadsmarket.com/post/data.aspx',\n      leadsMarketPayload,\n      {\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        timeout: 120000 // 120 seconds\n      }\n    );\n\n    const apiResponse = response.data;\n    console.log('‚úÖ LeadsMarket Response:', apiResponse);\n\n    // 4. Parse errors if they exist\n    let parsedErrors = [];\n    if (apiResponse.Errors) {\n      if (Array.isArray(apiResponse.Errors)) {\n        parsedErrors = apiResponse.Errors.map(err => ({\n          field: err.Field || '',\n          value: err.Value || '',\n          description: err.Description || ''\n        }));\n      } else if (apiResponse.Errors.Error) {\n        const errors = Array.isArray(apiResponse.Errors.Error) \n          ? apiResponse.Errors.Error \n          : [apiResponse.Errors.Error];\n        parsedErrors = errors.map(err => ({\n          field: err.Field || '',\n          value: err.Value || '',\n          description: err.Description || ''\n        }));\n      }\n    }\n\n    // 5. Parse messages if they exist\n    let parsedMessages = [];\n    if (apiResponse.Messages) {\n      if (Array.isArray(apiResponse.Messages)) {\n        parsedMessages = apiResponse.Messages;\n      } else if (apiResponse.Messages.Message) {\n        parsedMessages = Array.isArray(apiResponse.Messages.Message) \n          ? apiResponse.Messages.Message \n          : [apiResponse.Messages.Message];\n      }\n    }\n\n    // 6. Save LeadsMarket response\n    const soldLead = new SoldLead({\n      leadId: lead._id,\n      result: String(apiResponse.Result), // Convert to string: \"1\", \"2\", \"4\"\n      campaignId: apiResponse.CampaignID,\n      leadsMarketLeadId: apiResponse.LeadID,\n      price: apiResponse.Price ? parseFloat(apiResponse.Price) : 0,\n      redirectUrl: apiResponse.RedirectURL,\n      errors: parsedErrors,\n      messages: parsedMessages,\n      rawResponse: apiResponse\n    });\n\n    await soldLead.save();\n    console.log('‚úÖ Saved to SoldLead collection');\n\n    // 7. Return appropriate response based on result\n    const result = String(apiResponse.Result);\n    \n    // Result = \"1\" or \"Accepted\" = Success\n    if (result === '1' || result.toLowerCase() === 'accepted') {\n      return res.status(200).json({\n        status: 'sold',\n        redirect_url: apiResponse.RedirectURL,\n        price: apiResponse.Price,\n        leadId: apiResponse.LeadID,\n        message: 'Lead accepted successfully'\n      });\n    }\n    \n    // Result = \"2\" or \"Rejected\" = Rejected\n    if (result === '2' || result.toLowerCase() === 'rejected') {\n      return res.status(200).json({\n        status: 'rejected',\n        messages: parsedMessages,\n        message: 'Unable to match with a lender at this time'\n      });\n    }\n    \n    // Result = \"Duplicate\"\n    if (result.toLowerCase() === 'duplicate') {\n      return res.status(200).json({\n        status: 'duplicate',\n        messages: parsedMessages,\n        message: 'Duplicate lead detected'\n      });\n    }\n    \n    // Result = \"4\" or \"Errors\" = Validation errors\n    if (result === '4' || result.toLowerCase() === 'errors' || parsedErrors.length > 0) {\n      return res.status(400).json({\n        status: 'validation_error',\n        errors: parsedErrors,\n        messages: parsedMessages,\n        message: 'Please correct the highlighted fields'\n      });\n    }\n\n    // Unknown result\n    return res.status(500).json({\n      status: 'error',\n      message: 'Unexpected response from LeadsMarket',\n      result: apiResponse.Result\n    });\n\n  } catch (error) {\n    console.error('‚ùå API Error:', error);\n    \n    // Handle axios errors\n    if (error.response) {\n      return res.status(500).json({\n        status: 'error',\n        message: 'LeadsMarket API error',\n        details: error.response.data\n      });\n    }\n    \n    return res.status(500).json({\n      status: 'error',\n      message: error.message || 'Internal server error'\n    });\n  }\n}\n\n// ===================================\n// FIXED Helper Functions for API\n// ===================================\n\n// Income Type - Only \"Employment\" or \"Benefits\" per API doc\nfunction mapIncomeTypeAPI(type) {\n  const mapping = {\n    'employment': 'Employment',\n    'selfemployment': 'Employment', // Map to Employment, not SelfEmployment\n    'benefits': 'Benefits',\n    'unemployed': 'Benefits'\n  };\n  return mapping[type] || 'Employment';\n}\n\n// Call Time - Exact case matching\nfunction mapCallTimeAPI(time) {\n  const mapping = {\n    'anytime': 'Anytime',\n    'morning': 'Morning',\n    'afternoon': 'Afternoon',\n    'evening': 'Evening'\n  };\n  return mapping[time] || 'Anytime';\n}\n\n// Loan Purpose - Exact values from API doc (no spaces, proper case)\nfunction mapLoanPurposeAPI(purpose) {\n  const mapping = {\n    'debt_consolidation': 'Debtconsolidation',\n    'credit_card': 'Creditcard',\n    'home_improvement': 'Homeimprovement',\n    'student_loan': 'Studentloanconsolidation',\n    'major_purchase': 'Majorpurchase',\n    'auto_repair': 'Car',\n    'car': 'Car',\n    'green_loan': 'Greenloan',\n    'business': 'Business',\n    'vacation': 'Vacation',\n    'wedding': 'Wedding',\n    'relocation': 'Relocation',\n    'medical': 'Medical',\n    'household': 'Household',\n    'emergency': 'Other',\n    'other': 'Other'\n  };\n  return mapping[purpose] || 'Other';\n}\n\n// Credit Rating - Exact values from API doc\nfunction mapCreditRatingAPI(rating) {\n  const mapping = {\n    'excellent': 'Excellent',\n    'verygood': 'Verygood',\n    'good': 'Good',\n    'fair': 'Fair',\n    'poor': 'Poor',\n    'verypoor': 'Verypoor'\n  };\n  return mapping[rating] || 'Unsure';\n}\n\n// Helper functions for database (more readable)\nfunction mapIncomeType(type) {\n  const mapping = {\n    'employment': 'Employment',\n    'selfemployment': 'Self-Employment',\n    'benefits': 'Benefits',\n    'unemployed': 'Unemployed'\n  };\n  return mapping[type] || 'Employment';\n}\n\nfunction mapCallTime(time) {\n  const mapping = {\n    'anytime': 'Anytime',\n    'morning': 'Morning',\n    'afternoon': 'Afternoon',\n    'evening': 'Evening'\n  };\n  return mapping[time] || 'Anytime';\n}\n\nfunction mapLoanPurpose(purpose) {\n  const mapping = {\n    'debt_consolidation': 'Debt Consolidation',\n    'home_improvement': 'Home Improvement',\n    'auto_repair': 'Auto Repair',\n    'medical': 'Medical',\n    'emergency': 'Emergency',\n    'vacation': 'Vacation',\n    'business': 'Business',\n    'other': 'Other'\n  };\n  return mapping[purpose] || 'Other';\n}\n\nfunction mapCreditRating(rating) {\n  const mapping = {\n    'excellent': 'Excellent',\n    'good': 'Good',\n    'fair': 'Fair',\n    'poor': 'Poor',\n    'verypoor': 'Very Poor'\n  };\n  return mapping[rating] || 'Unsure';\n}\n\nfunction getNextFriday() {\n  const today = new Date();\n  const dayOfWeek = today.getDay();\n  const daysUntilFriday = (5 - dayOfWeek + 7) % 7 || 7;\n  const nextFriday = new Date(today);\n  nextFriday.setDate(today.getDate() + daysUntilFriday);\n  \n  return `${String(nextFriday.getMonth() + 1).padStart(2, '0')}/${String(nextFriday.getDate()).padStart(2, '0')}/${nextFriday.getFullYear()}`;\n}"],"names":[],"mappings":"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","debugId":null}}]
}